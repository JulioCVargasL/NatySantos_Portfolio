{% extends 'layouts/app.html' %}
{% load static %}

{% block title %}
Bodas | Nathy Santos
{% endblock %}

{% block content %}

<section class="gallery-section hover-carousel group">
  <!-- Imagen principal -->
  <img id="mainImage" src="{% static 'img/webp_format/weddings/boda1.webp' %}" class="gallery-background" alt="Foto principal">
  <div class="overlay"></div>
  <div class="hover-zone"></div>
  
  <!-- Carrusel horizontal -->
  <div class="carousel flex space-x-4 overflow-x-auto p-4">
     {% for filename in images %}
    <img 
      src="{% static 'img/webp_format/weddings/' %}{{ filename }}"
      onclick="changeBackground(this.src)"
      alt="Foto"
      class="h-28 rounded cursor-pointer hover:opacity-80 transition"
    >
{% endfor %}
  </div>
</section>

<script>

  let currentIndex = 0;
  const imageList = [
    {% for filename in images %}
      "{% static 'img/webp_format/weddings/' %}{{ filename }}",
    {% endfor %}
  ];

  function changeBackground(imageSrc) {
    const mainImage = document.getElementById("mainImage");
    mainImage.src = imageSrc;
    currentIndex = imageList.indexOf(imageSrc);
  }

  // Teclas izquierda/derecha
  document.addEventListener("keydown", (e) => {
    const carouselVisible = parseFloat(getComputedStyle(document.querySelector('.carousel')).opacity) > 0;
    if (carouselVisible) return; // No cambia si el carrusel estÃ¡ visible

    if (e.key === "ArrowRight") {
      currentIndex = (currentIndex + 1) % imageList.length;
      changeBackground(imageList[currentIndex]);
    } else if (e.key === "ArrowLeft") {
      currentIndex = (currentIndex - 1 + imageList.length) % imageList.length;
      changeBackground(imageList[currentIndex]);
    }
  });


 function changeBackground(imageSrc) {
    const relativePath = imageSrc.split("/static/")[1];
    const mainImage = document.getElementById("mainImage");
    mainImage.src = "/static/" + relativePath;
  }

  const carousel = document.querySelector('.carousel');
  const hoverZone = document.querySelector('.hover-zone');

  hoverZone.addEventListener('mouseenter', () => {
    carousel.style.opacity = '1';
    carousel.style.pointerEvents = 'auto';
  });

  carousel.addEventListener('mouseleave', () => {
    carousel.style.opacity = '0';
    carousel.style.pointerEvents = 'none';
  });
</script>

{% endblock %}